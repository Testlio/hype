machine:
    node:
        version: "5.7.0"
    environment:
        CIRCLE_BUILD_DIR: $HOME/$CIRCLE_PROJECT_REPONAME
        PATH: $PATH:/$CIRCLE_BUILD_DIR/bin
    post:
        - mkdir -p $CIRCLE_BUILD_DIR/bin

dependencies:
    pre:
        - bash ./circleci/install-hugo.sh
        - npm install -g upload-to-s3
    cache_directories:
        - bin
        - node_modules

test:
    override:
        - hugo -v

deployment:
    upload:
        branch: master
        commands:
            - upload-to-s3 -b hype.testlio.com -p public ./public
